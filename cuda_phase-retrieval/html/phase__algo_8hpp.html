<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CUDA Phase Retrieval: phase_algo.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CUDA Phase Retrieval
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">phase_algo.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;pybind11/numpy.h&gt;</code><br />
<code>#include &lt;pybind11/pybind11.h&gt;</code><br />
<code>#include &lt;cufft.h&gt;</code><br />
<code>#include &lt;cuComplex.h&gt;</code><br />
<code>#include &lt;curand.h&gt;</code><br />
<code>#include &lt;curand_kernel.h&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
</div>
<p><a href="phase__algo_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a598a3330b3c21701223ee0ca14316eca">PI</a>&#160;&#160;&#160;3.1415926535897932384626433</td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf2b8792be9f99ad11147059ef5079d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#aeaf2b8792be9f99ad11147059ef5079d">CUDA_CHECK</a>(call)&#160;&#160;&#160;{cudaError_t error = call; if(error!=cudaSuccess){printf(&quot;&lt;%s&gt;:%i &quot;,__FILE__,__LINE__); printf(&quot;[CUDA] Error: %s\n&quot;, cudaGetErrorString(error));}}</td></tr>
<tr class="separator:aeaf2b8792be9f99ad11147059ef5079d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a48b6d381bdf7e7f422c48767d028c91f"><td class="memItemLeft" align="right" valign="top">__device__ cufftDoubleComplex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a48b6d381bdf7e7f422c48767d028c91f">gpu_exp</a> (cufftDoubleComplex arg)</td></tr>
<tr class="separator:a48b6d381bdf7e7f422c48767d028c91f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a897e039e2f0572f7660954195545e1c9"><td class="memItemLeft" align="right" valign="top">__device__ cufftDoubleComplex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a897e039e2f0572f7660954195545e1c9">normalize</a> (cufftDoubleComplex comp_data, int size)</td></tr>
<tr class="separator:a897e039e2f0572f7660954195545e1c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c934623d29bce09d5c599b701e0e11"><td class="memItemLeft" align="right" valign="top">__device__ cufftDoubleComplex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a19c934623d29bce09d5c599b701e0e11">get_complex</a> (double real_data)</td></tr>
<tr class="separator:a19c934623d29bce09d5c599b701e0e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182f10c5d939ae0f7e67c4d822216e3b"><td class="memItemLeft" align="right" valign="top">__device__ double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a182f10c5d939ae0f7e67c4d822216e3b">get_real</a> (cufftDoubleComplex comp_data)</td></tr>
<tr class="separator:a182f10c5d939ae0f7e67c4d822216e3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c4f0a12a8dc2b3de7af0e8a8b54447"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#aa0c4f0a12a8dc2b3de7af0e8a8b54447">get_complex_array</a> (double *real_array, cufftDoubleComplex *complex_array, int dimension)</td></tr>
<tr class="separator:aa0c4f0a12a8dc2b3de7af0e8a8b54447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85b84741ca71c56b9a0766108e92bb4c"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a85b84741ca71c56b9a0766108e92bb4c">get_absolute_array</a> (cufftDoubleComplex *complex_array, double *real_array, int dimension)</td></tr>
<tr class="separator:a85b84741ca71c56b9a0766108e92bb4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d028d41a0612f76efd71e8ab35ad3f9"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a2d028d41a0612f76efd71e8ab35ad3f9">init_random</a> (double seed, curandState_t *states, int dimension)</td></tr>
<tr class="separator:a2d028d41a0612f76efd71e8ab35ad3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585835ae6298812fae3e0d13e10a6cb8"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a585835ae6298812fae3e0d13e10a6cb8">random_phase</a> (double *random, cufftDoubleComplex *y_hat, double *ptrMag, int dimension)</td></tr>
<tr class="separator:a585835ae6298812fae3e0d13e10a6cb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0164dab2d8f7634c5e1e0802e2d3a7d1"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a0164dab2d8f7634c5e1e0802e2d3a7d1">random_phase_cudastate</a> (curandState_t *states, cufftDoubleComplex *y_hat, double *ptrMag, int dimension)</td></tr>
<tr class="separator:a0164dab2d8f7634c5e1e0802e2d3a7d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7f3b762a78fafb43d0243fd9381a91"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a2f7f3b762a78fafb43d0243fd9381a91">satisfy_fourier</a> (cufftDoubleComplex *y_hat, cufftDoubleComplex *x_hat, double *ptrMag, int dimension)</td></tr>
<tr class="separator:a2f7f3b762a78fafb43d0243fd9381a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab931575201ebc55b60c58fc55ad2223b"><td class="memItemLeft" align="right" valign="top">__global__ void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#ab931575201ebc55b60c58fc55ad2223b">process_arrays</a> (double *mask, cufftDoubleComplex *y_hat, double *image_x, double *image_x_p, cufftDoubleComplex *image_x_comp, double beta, int mode, int iter, int dimension)</td></tr>
<tr class="separator:ab931575201ebc55b60c58fc55ad2223b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0404195afc6eca1973e90ff75a1b6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a4e0404195afc6eca1973e90ff75a1b6f">CUFFT_CHECK</a> (cufftResult cufft_process)</td></tr>
<tr class="separator:a4e0404195afc6eca1973e90ff75a1b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38defc003021ab94f873d776bb851e54"><td class="memItemLeft" align="right" valign="top">py::array_t&lt; double, py::array::c_style &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#a38defc003021ab94f873d776bb851e54">fienup_phase_retrieval</a> (py::array_t&lt; double, py::array::c_style &gt; image, py::array_t&lt; double, py::array::c_style &gt; masks, int steps, string mode, double beta, py::array_t&lt; double, py::array::c_style &gt; randoms)</td></tr>
<tr class="separator:a38defc003021ab94f873d776bb851e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abaeefe77f3cf7d052b5ede628b1b471b"><td class="memItemLeft" align="right" valign="top">py::array_t&lt; double, py::array::c_style &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__algo_8hpp.html#abaeefe77f3cf7d052b5ede628b1b471b">fienup_phase_retrieval</a> (py::array_t&lt; double, py::array::c_style &gt; image, py::array_t&lt; double, py::array::c_style &gt; masks, int steps, string mode, double beta)</td></tr>
<tr class="separator:abaeefe77f3cf7d052b5ede628b1b471b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aeaf2b8792be9f99ad11147059ef5079d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf2b8792be9f99ad11147059ef5079d">&#9670;&nbsp;</a></span>CUDA_CHECK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CUDA_CHECK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">call</td><td>)</td>
          <td>&#160;&#160;&#160;{cudaError_t error = call; if(error!=cudaSuccess){printf(&quot;&lt;%s&gt;:%i &quot;,__FILE__,__LINE__); printf(&quot;[CUDA] Error: %s\n&quot;, cudaGetErrorString(error));}}</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a598a3330b3c21701223ee0ca14316eca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a598a3330b3c21701223ee0ca14316eca">&#9670;&nbsp;</a></span>PI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PI&#160;&#160;&#160;3.1415926535897932384626433</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4e0404195afc6eca1973e90ff75a1b6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0404195afc6eca1973e90ff75a1b6f">&#9670;&nbsp;</a></span>CUFFT_CHECK()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CUFFT_CHECK </td>
          <td>(</td>
          <td class="paramtype">cufftResult&#160;</td>
          <td class="paramname"><em>cufft_process</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abaeefe77f3cf7d052b5ede628b1b471b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaeefe77f3cf7d052b5ede628b1b471b">&#9670;&nbsp;</a></span>fienup_phase_retrieval() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">py::array_t&lt;double, py::array::c_style&gt; fienup_phase_retrieval </td>
          <td>(</td>
          <td class="paramtype">py::array_t&lt; double, py::array::c_style &gt;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">py::array_t&lt; double, py::array::c_style &gt;&#160;</td>
          <td class="paramname"><em>masks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a38defc003021ab94f873d776bb851e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38defc003021ab94f873d776bb851e54">&#9670;&nbsp;</a></span>fienup_phase_retrieval() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">py::array_t&lt;double, py::array::c_style&gt; fienup_phase_retrieval </td>
          <td>(</td>
          <td class="paramtype">py::array_t&lt; double, py::array::c_style &gt;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">py::array_t&lt; double, py::array::c_style &gt;&#160;</td>
          <td class="paramname"><em>masks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">py::array_t&lt; double, py::array::c_style &gt;&#160;</td>
          <td class="paramname"><em>randoms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>CUDA Phase Retrieval primary function with random array as parameter </p>
<p>Asserting inputs</p>
<p>&lt; Generate image array from pybind array</p>
<p>&lt; Generate mask array from pybind array</p>
<p>&lt; Generate array of uniform random from pybind array</p>
<p>&lt; use integer instead of string for mode</p>
<p>&lt; Get 1D image array</p>
<p>&lt; Width of image</p>
<p>&lt; Height of image</p>
<p>&lt; Mask array, same size as image</p>
<p>&lt; Array of uniform random number, same size as image</p>
<p>&lt; Convert X to integer to prevent getting warning from CUFFT</p>
<p>&lt; Convert Y to integer to prevent getting warning from CUFFT</p>
<p>&lt; Area or dimension of image, mask, and array of random</p>
<p>Initialize arrays in GPU</p>
<p>&lt; Source image in GPU</p>
<p>&lt; Magnitudes in GPU</p>
<p>&lt; Mask in GPU</p>
<p>&lt; Image output in GPU</p>
<p>&lt; Save previous image output in GPU for iteration</p>
<p>&lt; Array of random in GPU</p>
<p>&lt; Sample random phase in GPU</p>
<p>&lt; complex number version of source image in GPU</p>
<p>&lt; Complex number version of image output in GPU</p>
<p>Allocating memories in GPU</p>
<p>Allocating inital values of output image to 0 in GPU</p>
<p>Set number of SM for CUDA Kernel</p>
<p>Convert the source image array into array of complex number After that, do CUFFT first time to the complex source image, then get the absolute value of the result The absolute result is called magnitude</p>
<p>Copy mask and array of random to GPU</p>
<p>Do initial random phase</p>
<p>For every iteration :</p><ol type="1">
<li>Create 2D CUFFT plan using complex double to complex double</li>
<li>Do CUFFT Inverse to the random phase array</li>
<li>Process arrays, generating 2 version result image array, complex version and real version</li>
<li>The real version of result image array is the result used as output</li>
<li>Do normal FFT to the complex version of result image array</li>
<li>Combine the FFT'ed result with the random phase array</li>
<li>Use the combined array is used as random phase array fo the next iterarion</li>
</ol>
<p>Create a pybind array to store the final image result</p>
<p>Free CUDA arrays</p>
<p>Return the final result image</p>

</div>
</div>
<a id="a85b84741ca71c56b9a0766108e92bb4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85b84741ca71c56b9a0766108e92bb4c">&#9670;&nbsp;</a></span>get_absolute_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void get_absolute_array </td>
          <td>(</td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>complex_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>real_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get array of absolute value from array of complex number </p>

</div>
</div>
<a id="a19c934623d29bce09d5c599b701e0e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19c934623d29bce09d5c599b701e0e11">&#9670;&nbsp;</a></span>get_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ cufftDoubleComplex get_complex </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>real_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert real number to CUFFT complex number using 0 as imaginary part </p>

</div>
</div>
<a id="aa0c4f0a12a8dc2b3de7af0e8a8b54447"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0c4f0a12a8dc2b3de7af0e8a8b54447">&#9670;&nbsp;</a></span>get_complex_array()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void get_complex_array </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>real_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>complex_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Convert array of real number into array of complex number </p>

</div>
</div>
<a id="a182f10c5d939ae0f7e67c4d822216e3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182f10c5d939ae0f7e67c4d822216e3b">&#9670;&nbsp;</a></span>get_real()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ double get_real </td>
          <td>(</td>
          <td class="paramtype">cufftDoubleComplex&#160;</td>
          <td class="paramname"><em>comp_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get real number part of a CUFFT complex number </p>

</div>
</div>
<a id="a48b6d381bdf7e7f422c48767d028c91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48b6d381bdf7e7f422c48767d028c91f">&#9670;&nbsp;</a></span>gpu_exp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ cufftDoubleComplex gpu_exp </td>
          <td>(</td>
          <td class="paramtype">cufftDoubleComplex&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate exponential of a double complex in GPU </p>

</div>
</div>
<a id="a2d028d41a0612f76efd71e8ab35ad3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d028d41a0612f76efd71e8ab35ad3f9">&#9670;&nbsp;</a></span>init_random()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void init_random </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>seed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">curandState_t *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create states for random values </p>

</div>
</div>
<a id="a897e039e2f0572f7660954195545e1c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a897e039e2f0572f7660954195545e1c9">&#9670;&nbsp;</a></span>normalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__device__ cufftDoubleComplex normalize </td>
          <td>(</td>
          <td class="paramtype">cufftDoubleComplex&#160;</td>
          <td class="paramname"><em>comp_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normalize every result elements of CUFFT_INVERSE </p>

</div>
</div>
<a id="ab931575201ebc55b60c58fc55ad2223b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab931575201ebc55b60c58fc55ad2223b">&#9670;&nbsp;</a></span>process_arrays()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void process_arrays </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>y_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>image_x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>image_x_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>image_x_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Processing magnitudes with mask </p>
<p>&lt; Get real version of normalized complex number</p>
<p>Get previous image based on current iteration</p>
<p>Updates for elements that satisfy object domain constraint</p>
<p>find elements that violate object domain constraints or are not masked</p>
<p>check if any element y is less than zero</p>
<p>use "and" logical to check the "less than zero y" and the mask</p>
<p>Determine indices value</p>
<p>updates for elements that violate object domain constraints</p>

</div>
</div>
<a id="a585835ae6298812fae3e0d13e10a6cb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585835ae6298812fae3e0d13e10a6cb8">&#9670;&nbsp;</a></span>random_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void random_phase </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>y_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ptrMag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sample random phase using array of random from input </p>

</div>
</div>
<a id="a0164dab2d8f7634c5e1e0802e2d3a7d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0164dab2d8f7634c5e1e0802e2d3a7d1">&#9670;&nbsp;</a></span>random_phase_cudastate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void random_phase_cudastate </td>
          <td>(</td>
          <td class="paramtype">curandState_t *&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>y_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ptrMag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sample random phase using curandState_t as random value </p>

</div>
</div>
<a id="a2f7f3b762a78fafb43d0243fd9381a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f7f3b762a78fafb43d0243fd9381a91">&#9670;&nbsp;</a></span>satisfy_fourier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__global__ void satisfy_fourier </td>
          <td>(</td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>y_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cufftDoubleComplex *&#160;</td>
          <td class="paramname"><em>x_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ptrMag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dimension</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Satisfy fourier domain constraints </p>
<p>&lt; arg = atan2(imag, real)</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
